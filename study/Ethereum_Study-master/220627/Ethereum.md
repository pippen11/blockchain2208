# 블록체인

블록체인 네트워크
<br>

- miner
- P2P
- RPC (http)
- wallet

<br>

# 비트코인 vs 이더리움

차별점 존재 (스마트 컨트랙트 때문)
<br>
스마트 컨트랙트를 사용하면 거래에 있어서 추가적인 정보를 넣을 수 있다.
<br>
스마트 컨트랙트를 구현하기 위해 다음의 내용이 비트코인과 상이하다.
<br>

- EVM
- Transaction
- account

<br>
<br>

# 이더리움

## EVM (Ethereum Virtual Machine)

EVM을 사용해 트랜잭션 내용을 상태처럼 관리
<br>
EVM이 설치됨으로써 코드를 실행할 수 있게 된다. (코드 해석기)
<br>
Java의 JVM과 같은 역할.
가상머신을 사용해 자바의 코드를 해석할 수 있는 컴퓨터를 따로 설치한다.
가상머신이 코드를 해석해서 결과를 던져준다.
JVM만 같으면 어떠한 컴퓨터든 똑같은 결과를 얻는다.
JVM을 사용하면 어떤 OS에서든 똑같이 돌아가지만 범용성에 최적화 되어있기 때문에 효율적이지는 않다.
<br>
<br>
옛날에는 컴퓨터에 최적화 되게끔 OS에 따라 빌드를 달리 해줬다. (하드웨어에 따라 결과가 달라진다.)
<br>
하지만 분산 네트워크에서는 같은 코드로 똑같은 결과를 얻어야만 한다.
<br>
EVM을 사용해 어디에서든 코드가 똑같이 돌아가게끔 해준다.
<br>
<br>

마이너(miner) 노드에 EVM이 존재
<br>
EVM을 통해 tx 안에 작성된 코드를 검증한다.
<br>
일반 노드들은 컴파일러를 사용해 솔리디티로 작성된 코드를 바이트 코드로 변환해 줄 수만 있으면 된다.
<br>
코드 작성 -> 컴파일 -> 컴파일 된 바이트 코드로 트랜잭션 생성
<br>
마이너 노드에서 EVM을 통해 코드를 실행하고 유효성을 검사.
<br>
<br>
바이트 코드로 변경할 수 있는 코드라면 언어에 상관 없이 EVM을 통해 똑같은 결과를 얻을 수 있다. // more
<br>
즉, 컴파일만 진행할 수 있다면 어떠한 언어로든 스마트 컨트랙트를 작성할 수 있다.
(컴파일된 바이트 코드를 EVM에게 전달)
<br>
<br>

## Transaction

- 이더리움 네트워크에는 가스(Gas)라는 개념이 존재
- 이더스캔 -> Input Data 가 비어있으면 돈만 전송하는 트랜잭션 , 채워져 있으면 코드를 실행하는 트랜잭션

```ts
const tx = {
  from: 0x2313132132,
  to: 0x131314341232,
  value: 1010100,
  data: 0x1929310293,
};
```

web3 라이브러리를 사용하면 axios , curl 을 사용해서 했던 요청과 같은 처리를 할 수 있다.
<br>
<br>

## account

스마트 컨트랙트로 인해 2 종류의 account가 존재

- EOA (External Owned Account) : 외부소유계정, 이더리움의 입출금에 대한 내용으로만 사용하는 계정
- CA (Contract Account) : 계약계정, 특정 블록의 어떠한 트랜잭션에 코드가 들어있는지 알 수 있는 고유키값, 해당 계정으로 돈의 입출금도 가능,

이더리움은 트랜잭션 내용에 코드를 넣는다.
트랜잭션을 발동시키는 사람의 계정이 EOA, EOA가 CA를 소유하게 된다.

```js
tx
{
    from : EOA
    to : empty
    value : empty
    gas : 0.5 ETH // 수수료
}
```

<br>
어떤 블록의 어떤 트랜잭션인지에 대한 고유키 값 : CA
<br>
CA는 배포한 사람만 알 수 있다. EOA 계정 소유자만 CA 접근 가능. 마치 개인키를 받듯이 CA를 받는다는 개념.
<br>

이더리움 트랜잭션 객체의 상태값

- 계정 : EOA , CA 두가지 존재

EOA

- balance (밸런스) : 잔액
- nonce (논스) : 트랜잭션 횟수를 표현 (거래 횟수) , EVM이 동작했는지 안했는지로 횟수 카운팅

논스 = 성공적으로 전송한 트랜잭션의 수

<br>

CA

- balance (밸런스) : 잔액
- nonce (논스) : 트랜잭션 횟수를 표현 (거래 횟수) , EVM이 동작했는지 안했는지로 횟수 카운팅
- 코드 해시 : 스마트 컨트랙트 코드의 해시값이며 이를 이용해 실제 실행코드가 저장된 위치를 찾을 수 있다.
- 스토리지 해시 : 스마트 컨트랙트가 관리하는 상태 데이터가 저장된 스토리지의 해시값으로 스토리지의 실제 위치를 나타내준다.
