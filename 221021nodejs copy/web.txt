document.getElementById("menu-btn").onclick = function (e) {
  document.getElementById("user-input-container").classList.toggle("on");
};

//2
document.getElementById("board-add").onsubmit = async function (e) {
  e.preventDefault();
  if (!e.target["board-title"].value) {
    e.target["board-title"].focus();
    return;
  }

  if (!e.target["board-text"].value) {
    e.target["board-text"].focus();
    return;
  }
  console.log(e.target["board-title"].value);
  console.log(e.target["board-text"].value);

  try {
    const data = await axios.post("/api/board/add", {
      title: e.target["board-title"].value,
      text: e.target["board-text"].value,
      uptime: Date.now(),
    });
    console.log(data.data);
    if (data.data.status == 200) {
      e.target["board-title"].value = e.target["board-text"].value = "";
    }
  } catch (err) {
    console.log(err);
  }

  //4
  getList();
};

//form 안에 있는 button은 기본적으로 form의 submit을 실행

let maxCount = 2; // 총페이지수
let count = 0; //현재페이지

const pageElem = document.getElementById("page");

const listElem = document.getElementById("list");

//4
async function getList() {
  //5
  try {
    const data = await axios.get("/api/board?count=" + count);
    // count =0 ->/api/board?coun=0
    pageElem.innerHTML = "";
    maxCount = data.data.maxCount;
    for (let i = 0; i < maxCount; ++i) {
      const tempLi = document.createElement("li");
      //페이지 ;ul에 넣어줌
      tempLi.innerText = i + 1;
      tempLi.onclick = function (e) {
        count = i;
        //입력된거 몇번째애인지 바꿔줌

        pageElem.getElementsByClassName("now")[0].classList.remove("now");
        tempLi.classList.add("now");
        getList();
      };
      if (count === i) {
        tempLi.classList.add("now");
      }
      pageElem.append(tempLi);
    }
    console.log(data.data.list);
    listElem.innerHTML = "";

    //1
    data.data.list.forEach((data) => {
      const tempLi = document.createElement("li");
      const tempTitle = document.createElement("div");
      const tempH3 = document.createElement("h3");
      const tempImg = document.createElement("img");
      const tempText = document.createElement("div");
      const tempP = document.createElement("p");
      const tempTextarea = document.createElement("textarea");
      const tempBtnBox = document.createElement("div");
      const tempDelBtn = document.createElement("img");
      const tempEditBtn = document.createElement("img");

      tempTitle.classList.add("title");

      tempTitle.onclick = function (e) {
        tempText.classList.toggle("on");
        tempImg.classList.toggle("on");
        tempText.classList.remove("edit");
      };

      tempText.classList.add("text");
      tempImg.src = "imgs/angle-up-solid.svg";
      tempImg.alt = "list-item-btn";
      tempH3.innerText = data.title;
      tempP.innerText = data.text;
      tempTextarea.value = data.text;

      tempBtnBox.classList.add("list-btn-box");
      tempDelBtn.src = "./imgs/minus-solid.svg";
      tempDelBtn.alt = "delete-btn";
      tempEditBtn.src = "./imgs/plus-solid.svg";
      tempEditBtn.alt = "edit-btn";

      tempDelBtn.onclick = async function (e) {
        try {
          const data = await axios.post("/api/board/delete", {
            count,
            num: index,
          });
          console.log(data.data);
        } catch (err) {
          console.log(err);
        }
      };

      tempEditBtn.onclick = async function (e) {
        try {
          const data = await axios.post("/api/board/update");
          console.log(data.data);
        } catch (err) {
          console.log(err);
        }
      };

      tempBtnBox.append(tempEditBtn);
      tempBtnBox.append(tempDelBtn);

      tempTitle.append(tempH3);
      tempTitle.append(tempImg);
      tempText.append(tempP);
      tempText.append(tempTextarea);
      tempText.append(tempBtnBox);
      tempLi.append(tempTitle);
      tempLi.append(tempText);
      listElem.append(tempLi);
    });
  } catch (err) {
    console.error(err);
  }
}
//4
getList();

// axios.get("/api/board").then((data) => {
//   console.log(data);
// });

// axios.post("/api/board/add").then((data) => {
//   console.log(data);
// });
